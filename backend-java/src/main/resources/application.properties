############################################
# DEFAULT Configuration (Local Development)
# - Dev profile enabled by default
# - Sensible local defaults
# - Can be overridden with environment variables
# - For production, set: SPRING_PROFILES_ACTIVE=prod
############################################

############################################
# Server
############################################
server.port=${PORT:8001}
server.address=0.0.0.0
spring.application.name=marketlens-backend

# âœ… Default to dev profile for local development
# Override with: SPRING_PROFILES_ACTIVE=prod
spring.profiles.active=${SPRING_PROFILES_ACTIVE:dev}


############################################
# PostgreSQL (Environment-Variable Driven)
############################################
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:marketlens}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true


############################################
# MongoDB (Environment-Variable Driven)
############################################
spring.data.mongodb.uri=${MONGODB_URI:mongodb://localhost:27017/marketlens}
spring.data.mongodb.database=${MONGODB_DATABASE:marketlens}


############################################
# Async Execution
############################################
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=25
spring.task.execution.thread-name-prefix=analysis-


############################################
# CORS (Environment-Variable Driven)
############################################
cors.allowed.origins=${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://127.0.0.1:3000,http://localhost:3001,http://127.0.0.1:3001}


############################################
# External API
############################################
yahoo.finance.api.base-url=https://query1.finance.yahoo.com


############################################
# Logging
############################################
logging.level.root=INFO
logging.level.com.marketlens=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n


############################################
# Actuator (Base Configuration)
# - Profile-specific settings in application-dev.properties and application-prod.properties
############################################
# Expose only safe endpoints (health and info)
management.endpoints.web.exposure.include=health,info

# Base path for actuator endpoints
management.endpoints.web.base-path=/actuator

# Health endpoint configuration
# - DB health checks (PostgreSQL + MongoDB) auto-configured via spring-boot-starter-data-*
# - show-details controlled by profile (dev: always, prod: when-authorized)
management.endpoint.health.show-components=always

# Info endpoint configuration
management.info.env.enabled=true
management.info.java.enabled=true
management.info.os.enabled=true


############################################
# OAuth2 Resource Server (JWT)
# NOTE: Only used when running in PROD profile
# In dev profile, these are ignored
############################################
spring.security.oauth2.resourceserver.jwt.issuer-uri=${JWT_ISSUER_URI:https://YOUR_DOMAIN.auth0.com/}
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=${JWT_JWK_SET_URI:https://YOUR_DOMAIN.auth0.com/.well-known/jwks.json}
